<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FaithReflects - The Weekly Altar</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body {
            background-color: #191919;
            color: #E3E3E3;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            overflow-x: hidden;
        }
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: #191919; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #444; }
        
        .animate-fade-in { animation: fadeIn 1s ease-out; }
        .animate-float { animation: float 6s ease-in-out infinite; }
        
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes float { 
            0% { transform: translateY(0px); } 
            50% { transform: translateY(-10px); } 
            100% { transform: translateY(0px); } 
        }

        /* Surrender Animation */
        .surrender-anim {
            animation: surrenderPath 2.5s forwards ease-in-out;
        }

        @keyframes surrenderPath {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1);
                color: #E3E3E3;
            }
            30% {
                opacity: 1;
                transform: translateY(-60px) scale(0.9);
                color: #E3E3E3;
            }
            50% {
                opacity: 0.9;
                transform: translateY(-80px) scale(1.1);
                color: #FCD34D; /* Gold glow */
                text-shadow: 0 0 20px #FCD34D;
            }
            100% {
                opacity: 0;
                transform: translateY(-180px) scale(1.3); /* Dissolve up into light */
                filter: blur(8px);
            }
        }

        /* Divine Light Beam */
        .light-beam {
            animation: beamDown 2s ease-out forwards;
            transform-origin: top center;
        }
        @keyframes beamDown {
            0% { opacity: 0; transform: scaleY(0); }
            20% { opacity: 0.6; transform: scaleY(1); }
            80% { opacity: 0.6; transform: scaleY(1); }
            100% { opacity: 0; transform: scaleY(1); }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // --- ICONS ---
        const Icons = {
            Cloud: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M17.5 19c0-1.7-1.3-3-3-3h-11a3 3 0 0 0-3 3h17z"/><path d="M16 16c2.5 0 4-2 4-4.5S17 7 15 7c-1 0-1.8.5-2.2 1.3C11.9 6.2 9.5 5 7.5 5 4.5 5 2 7.5 2 10.5c0 1.2.4 2.3 1 3.2"/></svg>,
            Refresh: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M8 16H3v5"/></svg>,
            Send: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m22 2-7 20-4-9-9-4Z"/><path d="M22 2 11 13"/></svg>,
            Check: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="20 6 9 17 4 12"/></svg>,
            X: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>,
            History: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 12"/><path d="M3 3v9h9"/><path d="M12 7v5l4 2"/></svg>
        };

        const { useState, useEffect } = React;

        // --- ALTAR COMPONENT ---
        const Altar = ({ activeItem, showLight }) => {
            return (
                <div className="relative w-full h-64 flex items-end justify-center mb-4">
                    
                    {/* Light Beam Effect */}
                    {showLight && (
                        <div className="absolute top-0 bottom-20 w-32 bg-gradient-to-b from-yellow-100/10 via-yellow-200/5 to-transparent pointer-events-none light-beam z-0 mix-blend-overlay"></div>
                    )}

                    {/* The Item Being Surrendered (Floating Text) */}
                    {activeItem && (
                        <div className="absolute bottom-24 z-20 w-full text-center pointer-events-none px-4">
                            <span className="surrender-anim text-lg font-serif font-bold inline-block px-4 py-2 drop-shadow-lg">
                                {activeItem}
                            </span>
                        </div>
                    )}

                    {/* Altar Graphic (SVG) */}
                    <svg viewBox="0 0 200 120" className="w-48 drop-shadow-2xl z-10">
                        {/* Top Slab */}
                        <path d="M20 40 L180 40 L170 60 H30 L20 40 Z" fill="#3E3E3E" stroke="#555" strokeWidth="1"/>
                        <rect x="30" y="60" width="140" height="10" fill="#2C2C2C" />
                        
                        {/* Base Stones */}
                        <rect x="40" y="70" width="120" height="40" fill="#2C2C2C" stroke="#444" strokeWidth="1" rx="2" />
                        <path d="M40 70 H160" stroke="#191919" strokeWidth="2" opacity="0.5"/>
                        <path d="M100 70 V110" stroke="#191919" strokeWidth="2" opacity="0.5"/>
                        
                        {/* Runes/Markings */}
                        <path d="M90 85 L100 95 L110 85" stroke="#9F6B53" strokeWidth="2" fill="none" opacity="0.6"/>
                    </svg>

                    {/* Glow Effect behind altar */}
                    <div className="absolute bottom-0 w-40 h-24 bg-[#9F6B53] opacity-15 blur-3xl rounded-full animate-pulse"></div>
                </div>
            );
        };

        // --- MAIN APP ---
        function App() {
            const [burden, setBurden] = useState('');
            const [activeAnim, setActiveAnim] = useState(null);
            const [showLight, setShowLight] = useState(false);
            const [surrenderedCount, setSurrenderedCount] = useState(0);
            const [history, setHistory] = useState([]); // New history log
            const [showResetConfirm, setShowResetConfirm] = useState(false);
            const [quoteIndex, setQuoteIndex] = useState(0);

            // Load saved data
            useEffect(() => {
                const savedCount = localStorage.getItem('faithreflects_surrendered');
                if (savedCount) setSurrenderedCount(parseInt(savedCount));
                
                const savedHistory = localStorage.getItem('faithreflects_surrendered_history');
                if (savedHistory) setHistory(JSON.parse(savedHistory));
            }, []);

            // Save data
            useEffect(() => {
                localStorage.setItem('faithreflects_surrendered', surrenderedCount.toString());
                localStorage.setItem('faithreflects_surrendered_history', JSON.stringify(history));
            }, [surrenderedCount, history]);

            const handleSurrender = (e) => {
                e.preventDefault();
                if (!burden.trim()) return;

                // Trigger Animation & Light
                setActiveAnim(burden);
                setShowLight(true);
                
                // Update State
                setSurrenderedCount(prev => prev + 1);
                setHistory(prev => [burden, ...prev].slice(0, 3)); // Keep last 3
                
                setBurden('');

                // Clear Animation after it plays
                setTimeout(() => {
                    setActiveAnim(null);
                    setShowLight(false);
                }, 2500);
            };

            const triggerReset = () => {
                setShowResetConfirm(true);
            };

            const confirmReset = () => {
                setSurrenderedCount(0);
                setHistory([]);
                setShowResetConfirm(false);
            };

            const quotes = [
                "Commit to the Lord whatever you do, and he will establish your plans. - Proverbs 16:3",
                "Cast all your anxiety on him because he cares for you. - 1 Peter 5:7",
                "Be still, and know that I am God. - Psalm 46:10",
                "Come to me, all you who are weary and burdened, and I will give you rest. - Matthew 11:28"
            ];

            // Rotate quotes occasionally
            useEffect(() => {
                setQuoteIndex(Math.floor(Math.random() * quotes.length));
            }, []);

            return (
                <div className="min-h-screen bg-[#191919] text-[#E3E3E3] font-sans flex flex-col p-6 max-w-sm mx-auto">
                    
                    {/* Header */}
                    <header className="flex justify-between items-center mb-8 relative z-20">
                        <div className="flex items-center space-x-1.5 text-stone-300">
                            <span className="text-xl">✨</span>
                            <span className="font-semibold tracking-tight text-base font-serif">FaithReflects</span>
                        </div>
                        <span className="text-[10px] bg-[#2C2C2C] px-2 py-1 rounded text-[#9F6B53] border border-[#333]">
                            Weekly Altar
                        </span>
                    </header>

                    {/* Intro Text */}
                    <div className="text-center mb-2 space-y-1 animate-fade-in relative z-10">
                        <h1 className="text-2xl font-bold text-white tracking-tight">Surrender First. <br/> Plan Second.</h1>
                        <p className="text-stone-500 text-xs leading-relaxed max-w-[200px] mx-auto">
                            Before you fill your calendar, empty your worries onto the altar.
                        </p>
                    </div>

                    {/* The Altar Interaction */}
                    <div className="flex-1 flex flex-col justify-center relative">
                        <Altar activeItem={activeAnim} showLight={showLight} />
                        
                        <form onSubmit={handleSurrender} className="relative z-30 mb-6">
                            <div className="relative group">
                                <input 
                                    type="text" 
                                    value={burden}
                                    onChange={(e) => setBurden(e.target.value)}
                                    placeholder="Type a worry to surrender..."
                                    className="w-full bg-[#2C2C2C] text-stone-200 placeholder-stone-600 px-4 py-4 rounded-xl border border-[#333] focus:border-[#9F6B53] focus:ring-1 focus:ring-[#9F6B53] outline-none transition-all shadow-lg text-center"
                                />
                                <button 
                                    type="submit"
                                    disabled={!burden.trim()}
                                    className={`absolute right-2 top-2 bottom-2 px-4 rounded-lg flex items-center justify-center transition-all ${!burden.trim() ? 'bg-transparent text-stone-600' : 'bg-[#9F6B53] text-white hover:bg-[#8F5B43] shadow-md'}`}
                                >
                                    <Icons.Send size={18} />
                                </button>
                            </div>
                        </form>

                        {/* Recent History (New Feature) */}
                        {history.length > 0 && (
                            <div className="flex flex-col items-center gap-2 animate-fade-in">
                                <span className="text-[9px] text-stone-600 uppercase tracking-widest flex items-center gap-1">
                                    <Icons.History size={10} /> Recently Given
                                </span>
                                <div className="flex flex-wrap justify-center gap-2">
                                    {history.map((item, idx) => (
                                        <span key={idx} className="text-[10px] bg-[#252525] text-stone-400 px-2 py-1 rounded-full border border-[#333] line-through decoration-[#9F6B53]/50">
                                            {item}
                                        </span>
                                    ))}
                                </div>
                            </div>
                        )}
                    </div>

                    {/* Stats / Footer */}
                    <div className="mt-8 border-t border-[#2C2C2C] pt-6 relative z-20">
                        <div className="flex justify-between items-center mb-4">
                            <div>
                                <span className="block text-2xl font-bold text-white font-mono">{surrenderedCount}</span>
                                <span className="text-[10px] text-stone-500 uppercase tracking-widest">Burdens Surrendered</span>
                            </div>
                            
                            {/* Reset Confirmation UI */}
                            {showResetConfirm ? (
                                <div className="flex items-center bg-[#2C2C2C] rounded-lg border border-[#333] p-1 shadow-lg animate-fade-in">
                                    <span className="text-[10px] mr-2 text-stone-400 pl-2">Reset All?</span>
                                    <button onClick={confirmReset} className="p-1 text-[#9F6B53] hover:text-white mr-1" title="Confirm">
                                        <Icons.Check size={14} />
                                    </button>
                                    <button onClick={() => setShowResetConfirm(false)} className="p-1 text-stone-500 hover:text-white" title="Cancel">
                                        <Icons.X size={14} />
                                    </button>
                                </div>
                            ) : (
                                <button onClick={triggerReset} className="text-stone-600 hover:text-stone-400 p-2 transition-colors rounded hover:bg-[#2C2C2C]" title="Reset Count">
                                    <Icons.Refresh size={14} />
                                </button>
                            )}
                        </div>

                        <div className="bg-[#202020] p-4 rounded-lg border border-[#333] text-center">
                            <p className="text-xs text-stone-400 italic font-serif">
                                "{quotes[quoteIndex]}"
                            </p>
                        </div>
                        
                        <div className="mt-6 text-center opacity-30 text-[9px]">
                            FaithReflects • Weekly Prep
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>