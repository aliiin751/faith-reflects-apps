<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FaithReflects Scripture Memory</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; }
        h1, h2, h3, .serif { font-family: 'Playfair Display', serif; }
        
        .fade-enter { opacity: 0; transform: translateY(10px); }
        .fade-enter-active { opacity: 1; transform: translateY(0); transition: opacity 300ms, transform 300ms; }
    </style>
</head>
<body class="bg-[#F5F5F4] flex items-center justify-center min-h-screen p-4">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Icons
        const IconEdit = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>;
        const IconEye = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>;
        const IconEyeOff = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/><line x1="1" y1="1" x2="23" y2="23"/></svg>;
        const IconType = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" y1="20" x2="15" y2="20"/><line x1="12" y1="4" x2="12" y2="20"/></svg>;
        const IconCheck = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polyline points="20 6 9 17 4 12"/></svg>;

        const App = () => {
            // Default verse
            const defaultVerse = "For God so loved the world that he gave his one and only Son, that whoever believes in him shall not perish but have eternal life.";
            const defaultRef = "John 3:16";

            const [text, setText] = useState(defaultVerse);
            const [reference, setReference] = useState(defaultRef);
            const [isEditing, setIsEditing] = useState(false);
            const [level, setLevel] = useState(0); // 0: Full, 1: Partial, 2: Initials
            const [hiddenIndices, setHiddenIndices] = useState([]);

            // Process text for display based on level
            const getProcessedText = () => {
                const words = text.split(' ');
                
                return words.map((word, index) => {
                    // Level 0: Show everything
                    if (level === 0) return word;

                    // Level 1: Hide random words (approx 50%)
                    if (level === 1) {
                        if (hiddenIndices.includes(index)) {
                            return "_".repeat(word.length);
                        }
                        return word;
                    }

                    // Level 2: Initials only
                    if (level === 2) {
                        // Keep punctuation, hide letters after first
                        const firstLetter = word.charAt(0);
                        const rest = word.slice(1).replace(/[a-zA-Z]/g, '_'); 
                        // Simplified: just first letter
                        return /^[a-zA-Z]/.test(word) ? word[0] + (word.length > 1 ? " Â·" : "") : word;
                    }
                    
                    return word;
                });
            };

            // Generate new random hidden indices when entering Level 1
            useEffect(() => {
                if (level === 1) {
                    const words = text.split(' ');
                    const indices = words.map((_, i) => i);
                    const shuffled = indices.sort(() => 0.5 - Math.random());
                    const selected = shuffled.slice(0, Math.floor(words.length * 0.5)); // Hide 50%
                    setHiddenIndices(selected);
                }
            }, [level, text]);

            const handleSave = () => {
                setIsEditing(false);
                setLevel(0);
            };

            return (
                <div className="w-full max-w-md bg-white rounded-3xl shadow-xl overflow-hidden border border-stone-200 flex flex-col min-h-[500px]">
                    
                    {/* Header */}
                    <div className="bg-stone-900 p-6 text-center">
                        <h1 className="text-white serif text-xl tracking-wide">Scripture Memory</h1>
                        <p className="text-stone-400 text-xs uppercase tracking-widest mt-1">FaithReflects Tools</p>
                    </div>

                    {/* Content Area */}
                    <div className="flex-grow p-8 flex flex-col justify-center items-center">
                        
                        {isEditing ? (
                            <div className="w-full space-y-4 animate-fade-in">
                                <div>
                                    <label className="block text-xs font-bold uppercase text-stone-500 mb-2">Verse Text</label>
                                    <textarea 
                                        value={text}
                                        onChange={(e) => setText(e.target.value)}
                                        className="w-full p-3 border border-stone-200 rounded-xl focus:ring-2 focus:ring-stone-800 outline-none text-stone-700 font-serif leading-relaxed h-32 resize-none"
                                        placeholder="Paste your verse here..."
                                    />
                                </div>
                                <div>
                                    <label className="block text-xs font-bold uppercase text-stone-500 mb-2">Reference</label>
                                    <input 
                                        type="text"
                                        value={reference}
                                        onChange={(e) => setReference(e.target.value)}
                                        className="w-full p-3 border border-stone-200 rounded-xl focus:ring-2 focus:ring-stone-800 outline-none text-stone-700 font-bold"
                                        placeholder="e.g. John 3:16"
                                    />
                                </div>
                                <button 
                                    onClick={handleSave}
                                    className="w-full py-3 bg-stone-800 text-white rounded-xl hover:bg-stone-700 transition-colors flex items-center justify-center gap-2"
                                >
                                    <IconCheck className="w-4 h-4" /> Save & Memorize
                                </button>
                            </div>
                        ) : (
                            <div className="text-center w-full">
                                <div className="mb-8 min-h-[160px] flex items-center justify-center">
                                    <p className="text-xl md:text-2xl serif text-stone-800 leading-loose transition-all duration-300">
                                        {getProcessedText().map((word, i) => (
                                            <span key={i} className={`inline-block mx-1 ${level === 1 && hiddenIndices.includes(i) ? 'text-stone-200 bg-stone-100 rounded px-1 select-none' : ''} ${level === 2 ? 'font-mono text-stone-600' : ''}`}>
                                                {word}
                                            </span>
                                        ))}
                                    </p>
                                </div>
                                <p className="text-stone-500 font-bold tracking-wide uppercase text-sm mb-8 border-t border-stone-100 pt-4 inline-block px-8">
                                    {reference}
                                </p>
                            </div>
                        )}
                    </div>

                    {/* Controls Footer */}
                    {!isEditing && (
                        <div className="bg-stone-50 p-4 border-t border-stone-100 grid grid-cols-4 gap-2">
                            <button 
                                onClick={() => setIsEditing(true)}
                                className="flex flex-col items-center justify-center p-2 text-stone-400 hover:text-stone-800 transition-colors"
                            >
                                <IconEdit className="w-5 h-5 mb-1" />
                                <span className="text-[10px] uppercase font-bold">Edit</span>
                            </button>

                            <button 
                                onClick={() => setLevel(0)}
                                className={`flex flex-col items-center justify-center p-2 rounded-xl transition-all ${level === 0 ? 'bg-white shadow-sm text-stone-800' : 'text-stone-400 hover:text-stone-600'}`}
                            >
                                <IconEye className="w-5 h-5 mb-1" />
                                <span className="text-[10px] uppercase font-bold">Read</span>
                            </button>

                            <button 
                                onClick={() => setLevel(1)}
                                className={`flex flex-col items-center justify-center p-2 rounded-xl transition-all ${level === 1 ? 'bg-white shadow-sm text-stone-800' : 'text-stone-400 hover:text-stone-600'}`}
                            >
                                <IconEyeOff className="w-5 h-5 mb-1" />
                                <span className="text-[10px] uppercase font-bold">Hide</span>
                            </button>

                            <button 
                                onClick={() => setLevel(2)}
                                className={`flex flex-col items-center justify-center p-2 rounded-xl transition-all ${level === 2 ? 'bg-white shadow-sm text-stone-800' : 'text-stone-400 hover:text-stone-600'}`}
                            >
                                <IconType className="w-5 h-5 mb-1" />
                                <span className="text-[10px] uppercase font-bold">Initials</span>
                            </button>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>