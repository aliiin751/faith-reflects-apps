<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FaithReflects - Ebenezer Builder</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body {
            background-color: #191919;
            color: #E3E3E3;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            overflow-x: hidden;
        }
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: #191919; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #444; }
        
        .animate-fade-in { animation: fadeIn 0.8s ease-out; }
        
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* Stone Drop Animation */
        .stone-drop { animation: dropStone 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }
        @keyframes dropStone {
            0% { transform: translateY(-200px) scale(0.8); opacity: 0; }
            70% { transform: translateY(10px) scale(1.05); opacity: 1; }
            100% { transform: translateY(0) scale(1); opacity: 1; }
        }

        .stone-hover:hover {
            filter: brightness(1.2);
            transform: scale(1.02);
            z-index: 50;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // --- ICONS ---
        const Icons = {
            Plus: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M5 12h14"/><path d="M12 5v14"/></svg>,
            Refresh: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M8 16H3v5"/></svg>,
            Info: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>,
            Check: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="20 6 9 17 4 12"/></svg>,
            X: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
        };

        const { useState, useEffect, useRef } = React;

        // --- STONE COMPONENT ---
        const Stone = ({ stone, onClick }) => {
            // Generate visual styles based on pre-calculated random properties
            const style = {
                width: `${stone.width}%`,
                marginLeft: `${stone.offsetX}%`,
                backgroundColor: stone.color,
                borderRadius: stone.borderRadius,
                height: `${stone.height}px`
            };

            return (
                <div 
                    onClick={() => onClick(stone)}
                    className="relative group w-full flex justify-center cursor-pointer transition-transform duration-200"
                >
                    <div 
                        className="stone-drop stone-hover shadow-lg border border-black/20 flex items-center justify-center"
                        style={style}
                    >
                        {/* Texture overlay */}
                        <div className="w-full h-full opacity-10 bg-[url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0IiBoZWlnaHQ9IjQiPgo8cmVjdCB3aWR0aD0iNCIgaGVpZ2h0PSI0IiBmaWxsPSIjZmZmIi8+CjxyZWN0IHdpZHRoPSIxIiBoZWlnaHQ9IjEiIGZpbGw9IiMwMDAiLz4KPC9zdmc+')]"></div>
                    </div>
                    
                    {/* Date Tooltip (Always visible on large screens, or subtle) */}
                    <div className="absolute right-2 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-50 text-[9px] text-stone-500 font-mono transition-opacity">
                        {stone.date}
                    </div>
                </div>
            );
        };

        // --- MAIN APP ---
        function App() {
            // State
            const [stones, setStones] = useState(() => {
                const saved = localStorage.getItem('faithreflects_ebenezer');
                return saved ? JSON.parse(saved) : [];
            });
            const [input, setInput] = useState('');
            const [selectedStone, setSelectedStone] = useState(null);
            const [showResetConfirm, setShowResetConfirm] = useState(false);

            useEffect(() => {
                localStorage.setItem('faithreflects_ebenezer', JSON.stringify(stones));
            }, [stones]);

            const addStone = (e) => {
                e.preventDefault();
                if (!input.trim()) return;

                // Create random visual properties for "organic" feel
                const newStone = {
                    id: Date.now(),
                    text: input,
                    date: new Date().toLocaleDateString(undefined, { month: 'short', day: 'numeric' }),
                    // Visual Randomization
                    width: 60 + Math.random() * 30, // 60-90% width
                    offsetX: (Math.random() * 10) - 5, // -5 to +5% offset
                    height: 35 + Math.random() * 20, // 35-55px height
                    borderRadius: `${Math.random() * 10 + 30}% ${Math.random() * 10 + 30}% ${Math.random() * 10 + 40}% ${Math.random() * 10 + 40}% / ${Math.random() * 20 + 30}%`,
                    color: ['#3E3E3E', '#4A4A4A', '#555555', '#2C2C2C', '#333333'][Math.floor(Math.random() * 5)]
                };

                setStones(prev => [newStone, ...prev]);
                setInput('');
                
                // Auto-select the new stone briefly to show it worked
                setSelectedStone(newStone);
                setTimeout(() => {
                    if (selectedStone?.id === newStone.id) setSelectedStone(null);
                }, 3000);
            };

            const triggerReset = () => {
                setShowResetConfirm(true);
            };

            const confirmReset = () => {
                setStones([]);
                setSelectedStone(null);
                setShowResetConfirm(false);
            };

            return (
                <div className="min-h-screen bg-[#191919] text-[#E3E3E3] font-sans flex flex-col p-4 max-w-sm mx-auto relative overflow-hidden">
                    
                    {/* Background Elements (Subtle Landscape) */}
                    <div className="absolute bottom-0 left-0 right-0 h-32 bg-gradient-to-t from-[#111] to-transparent pointer-events-none z-0"></div>
                    
                    {/* Header */}
                    <header className="flex justify-between items-center mb-6 relative z-10">
                        <div className="flex items-center space-x-1.5 text-stone-300">
                            <span className="text-xl">âœ¨</span>
                            <span className="font-semibold tracking-tight text-base font-serif">FaithReflects</span>
                        </div>
                        
                        {/* Custom Reset Confirmation */}
                        {showResetConfirm ? (
                            <div className="flex items-center bg-[#2C2C2C] rounded-lg border border-[#333] p-1 shadow-lg animate-fade-in absolute right-0 top-0">
                                <span className="text-[10px] mr-2 text-stone-400 pl-2">Clear All?</span>
                                <button onClick={confirmReset} className="p-1 text-[#9F6B53] hover:text-white mr-1" title="Confirm">
                                    <Icons.Check size={14} />
                                </button>
                                <button onClick={() => setShowResetConfirm(false)} className="p-1 text-stone-500 hover:text-white" title="Cancel">
                                    <Icons.X size={14} />
                                </button>
                            </div>
                        ) : (
                            <button onClick={triggerReset} className="text-stone-600 hover:text-stone-400 p-1.5 rounded hover:bg-[#2C2C2C] transition-colors" title="Reset">
                                <Icons.Refresh size={16} />
                            </button>
                        )}
                    </header>

                    {/* Title Area */}
                    <div className="text-center mb-6 relative z-10">
                        <h1 className="text-lg font-bold text-white mb-1">Ebenezer Stone</h1>
                        <p className="text-[#9F6B53] text-[10px] font-bold uppercase tracking-widest">1 Samuel 7:12</p>
                        <p className="text-stone-500 text-xs mt-1 italic">"Thus far the Lord has helped us."</p>
                    </div>

                    {/* Input Area */}
                    <form onSubmit={addStone} className="mb-8 relative z-20">
                        <div className="flex gap-2">
                            <input 
                                type="text" 
                                value={input}
                                onChange={(e) => setInput(e.target.value)}
                                placeholder="Record a blessing..."
                                className="w-full bg-[#2C2C2C] text-stone-200 placeholder-stone-600 px-4 py-3 rounded-xl border border-[#333] focus:border-[#9F6B53] outline-none transition-all shadow-lg text-sm"
                            />
                            <button 
                                type="submit"
                                disabled={!input.trim()}
                                className={`px-4 rounded-xl flex items-center justify-center transition-all ${!input.trim() ? 'bg-[#2C2C2C] text-stone-600' : 'bg-[#9F6B53] text-white hover:bg-[#8F5B43] shadow-md'}`}
                            >
                                <Icons.Plus size={20} />
                            </button>
                        </div>
                    </form>

                    {/* The Monument (Pile of Stones) */}
                    <div className="flex-1 flex flex-col-reverse items-center justify-start pb-12 relative z-10 min-h-[300px] overflow-y-auto custom-scroll px-4">
                        
                        {/* Base of the monument */}
                        <div className="w-4/5 h-4 bg-[#252525] rounded-[50%] blur-sm mb-[-10px] shrink-0"></div>

                        {stones.length === 0 && (
                            <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-center opacity-30">
                                <div className="text-4xl mb-2 grayscale">ðŸª¨</div>
                                <p className="text-xs">No stones raised yet.</p>
                            </div>
                        )}

                        {stones.map(stone => (
                            <Stone 
                                key={stone.id} 
                                stone={stone} 
                                onClick={setSelectedStone} 
                            />
                        ))}
                    </div>

                    {/* Selected Stone Detail Overlay */}
                    {selectedStone && (
                        <div className="absolute bottom-16 left-4 right-4 bg-[#2C2C2C] border border-[#9F6B53] p-4 rounded-xl shadow-2xl animate-fade-in z-30">
                            <div className="flex justify-between items-start mb-2">
                                <span className="text-[10px] text-stone-500 font-mono uppercase">{selectedStone.date}</span>
                                <button onClick={() => setSelectedStone(null)} className="text-stone-500 hover:text-white">
                                    <span className="text-xs">âœ•</span>
                                </button>
                            </div>
                            <p className="text-white text-sm font-serif leading-relaxed">
                                "{selectedStone.text}"
                            </p>
                        </div>
                    )}

                    <footer className="mt-auto text-center opacity-30 text-[9px] relative z-10 pt-4">
                        FaithReflects â€¢ Remembrance
                    </footer>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>