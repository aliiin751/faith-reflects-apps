<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FaithReflects - Spiritual Wheel</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body {
            background-color: #191919;
            color: #E3E3E3;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            overflow-x: hidden;
        }
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: #191919; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #444; }
        
        .animate-fade-in { animation: fadeIn 0.8s ease-out; }
        .animate-slide-up { animation: slideUp 0.6s ease-out; }
        .animate-pulse-slow { animation: pulse 3s infinite; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.8; } }

        /* Range Slider Styling */
        input[type=range] {
            -webkit-appearance: none; 
            background: transparent; 
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 16px;
            width: 16px;
            border-radius: 50%;
            background: #9F6B53;
            cursor: pointer;
            margin-top: -6px; 
            border: 2px solid #191919;
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 4px;
            cursor: pointer;
            background: #333;
            border-radius: 2px;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // --- ICONS ---
        const Icons = {
            Refresh: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M8 16H3v5"/></svg>,
            Save: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg>
        };

        const { useState, useEffect, useMemo } = React;

        // --- RADAR CHART COMPONENT ---
        const RadarChart = ({ data, categories }) => {
            const size = 300;
            const center = size / 2;
            const radius = 100;
            const levels = 5;

            // Calculate points for the polygon based on data values (1-10)
            const getPoints = (values) => {
                const total = categories.length;
                return categories.map((cat, i) => {
                    const angle = (Math.PI * 2 * i) / total - Math.PI / 2;
                    const value = values[cat.key] || 1;
                    const r = (value / 10) * radius;
                    const x = center + r * Math.cos(angle);
                    const y = center + r * Math.sin(angle);
                    return `${x},${y}`;
                }).join(" ");
            };

            // Calculate points for the background grid (perfect polygons)
            const getGridPoints = (level) => {
                const total = categories.length;
                return categories.map((_, i) => {
                    const angle = (Math.PI * 2 * i) / total - Math.PI / 2;
                    const r = (level / levels) * radius;
                    const x = center + r * Math.cos(angle);
                    const y = center + r * Math.sin(angle);
                    return `${x},${y}`;
                }).join(" ");
            };

            // Calculate label positions
            const getLabelPos = (i) => {
                const total = categories.length;
                const angle = (Math.PI * 2 * i) / total - Math.PI / 2;
                const r = radius + 25; // Push labels out further
                const x = center + r * Math.cos(angle);
                const y = center + r * Math.sin(angle);
                return { x, y };
            };

            const dataPoints = getPoints(data);

            return (
                <div className="relative w-full flex justify-center py-4">
                    <svg width={size} height={size} viewBox={`0 0 ${size} ${size}`} className="animate-pulse-slow">
                        {/* Background Grid (Web) */}
                        {[...Array(levels)].map((_, i) => (
                            <polygon 
                                key={i}
                                points={getGridPoints(i + 1)}
                                fill="none"
                                stroke="#333"
                                strokeWidth="1"
                                strokeDasharray="4 4"
                            />
                        ))}

                        {/* Axes Lines */}
                        {categories.map((_, i) => {
                            const angle = (Math.PI * 2 * i) / categories.length - Math.PI / 2;
                            const x = center + radius * Math.cos(angle);
                            const y = center + radius * Math.sin(angle);
                            return <line key={i} x1={center} y1={center} x2={x} y2={y} stroke="#333" strokeWidth="1" />;
                        })}

                        {/* Data Polygon (The Shape) */}
                        <polygon 
                            points={dataPoints}
                            fill="rgba(159, 107, 83, 0.4)" 
                            stroke="#9F6B53"
                            strokeWidth="2"
                            className="transition-all duration-500 ease-out"
                        />

                        {/* Data Dots */}
                        {categories.map((cat, i) => {
                            const angle = (Math.PI * 2 * i) / categories.length - Math.PI / 2;
                            const value = data[cat.key] || 1;
                            const r = (value / 10) * radius;
                            const x = center + r * Math.cos(angle);
                            const y = center + r * Math.sin(angle);
                            return (
                                <circle 
                                    key={i} 
                                    cx={x} cy={y} r="4" 
                                    fill="#E3E3E3" 
                                    stroke="#191919" 
                                    strokeWidth="2"
                                    className="transition-all duration-500 ease-out"
                                />
                            );
                        })}

                        {/* Labels */}
                        {categories.map((cat, i) => {
                            const pos = getLabelPos(i);
                            return (
                                <text 
                                    key={i} 
                                    x={pos.x} y={pos.y} 
                                    textAnchor="middle" 
                                    dominantBaseline="middle" 
                                    fill="#888" 
                                    fontSize="10" 
                                    fontWeight="bold"
                                    className="uppercase tracking-wider"
                                >
                                    {cat.label}
                                </text>
                            );
                        })}
                    </svg>
                </div>
            );
        };

        // --- MAIN APP ---
        function App() {
            // Default categories
            const categories = [
                { key: 'prayer', label: 'Prayer' },
                { key: 'word', label: 'Scripture' },
                { key: 'rest', label: 'Sabbath' },
                { key: 'service', label: 'Service' },
                { key: 'giving', label: 'Giving' },
                { key: 'community', label: 'Community' }
            ];

            // State
            const [scores, setScores] = useState(() => {
                const saved = localStorage.getItem('faithreflects_wheel');
                return saved ? JSON.parse(saved) : {
                    prayer: 5, word: 5, rest: 5, service: 5, giving: 5, community: 5
                };
            });

            useEffect(() => {
                localStorage.setItem('faithreflects_wheel', JSON.stringify(scores));
            }, [scores]);

            const handleSliderChange = (key, val) => {
                setScores(prev => ({ ...prev, [key]: parseInt(val) }));
            };

            const resetWheel = () => {
                if(confirm("Reset your wheel for a new month?")) {
                    setScores({ prayer: 5, word: 5, rest: 5, service: 5, giving: 5, community: 5 });
                }
            };

            // Calculate lowest area for prompt
            const lowestArea = useMemo(() => {
                const sorted = [...categories].sort((a, b) => scores[a.key] - scores[b.key]);
                return sorted[0]; // Returns category obj with lowest score
            }, [scores]);

            return (
                <div className="min-h-screen bg-[#191919] text-[#E3E3E3] font-sans flex flex-col p-4 max-w-md mx-auto">
                    
                    {/* Header */}
                    <header className="flex justify-between items-center mb-4">
                        <div className="flex items-center space-x-1.5 text-stone-300">
                            <span className="text-xl">✨</span>
                            <span className="font-semibold tracking-tight text-base font-serif">FaithReflects</span>
                        </div>
                        <div className="flex gap-2">
                            <button onClick={resetWheel} className="text-stone-600 hover:text-stone-400 p-1.5 rounded hover:bg-[#2C2C2C] transition-colors" title="Reset">
                                <Icons.Refresh size={16} />
                            </button>
                        </div>
                    </header>

                    <h1 className="text-center text-lg font-bold text-white mb-2">Monthly Spiritual Check-in</h1>
                    <p className="text-center text-xs text-stone-500 mb-6">Assess the balance of your walk with God.</p>

                    {/* The Chart */}
                    <div className="bg-[#202020] rounded-xl border border-[#333] mb-8 shadow-2xl overflow-hidden animate-fade-in">
                        <RadarChart data={scores} categories={categories} />
                    </div>

                    {/* Sliders Grid */}
                    <div className="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-8 animate-slide-up">
                        {categories.map(cat => (
                            <div key={cat.key} className="bg-[#2C2C2C] p-3 rounded-lg border border-[#333]">
                                <div className="flex justify-between mb-2">
                                    <label className="text-xs font-bold text-stone-400 uppercase tracking-wide">{cat.label}</label>
                                    <span className="text-xs font-mono text-[#9F6B53] font-bold">{scores[cat.key]}/10</span>
                                </div>
                                <input 
                                    type="range" 
                                    min="1" max="10" 
                                    value={scores[cat.key]} 
                                    onChange={(e) => handleSliderChange(cat.key, e.target.value)}
                                    className="w-full h-1 bg-[#444] rounded-lg appearance-none cursor-pointer"
                                />
                            </div>
                        ))}
                    </div>

                    {/* Reflection Prompt */}
                    <div className="bg-[#2C2C2C] p-4 rounded-xl border-l-4 border-[#9F6B53] animate-fade-in mt-auto">
                        <h3 className="text-[#9F6B53] text-xs font-bold uppercase tracking-widest mb-1">Focus Area</h3>
                        <p className="text-sm text-stone-300 leading-relaxed">
                            Your <span className="font-bold text-white">"{lowestArea.label}"</span> area seems to need attention this month. 
                            How can you invite God into this specific part of your life?
                        </p>
                    </div>

                    <footer className="mt-8 text-center opacity-30 text-[9px]">
                        FaithReflects • Monthly Reset
                    </footer>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>